name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ] # í˜•ë‹˜ ë©”ì¸ ë¸Œëœì¹˜ ì´ë¦„ì´ 'main'ì¸ì§€ 'master'ì¸ì§€ í™•ì¸! (ìš”ì¦˜ì€ ë³´í†µ main)

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      # 1. ìë°”(Java) ì„¸íŒ… (í”ŒëŸ¬í„° ë¹Œë“œì— í•„ìš”)
      - uses: actions/setup-java@v3
        with:
          distribution: 'zulu'
          java-version: '17'

      # 2. í”ŒëŸ¬í„° ì„¤ì¹˜
      - uses: subosito/flutter-action@v2
        with:
          channel: 'stable'
          
      # 3. íŒ¨í‚¤ì§€ ë‹¤ìš´ë¡œë“œ
      - run: flutter pub get

      # 4. ğŸ”¥ [í•µì‹¬] ì›¹ìœ¼ë¡œ ë¹Œë“œí•˜ê¸° (base-href ì„¤ì • í•„ìˆ˜!)
      # í˜•ë‹˜ ë¦¬íŒŒì§€í† ë¦¬ ì´ë¦„ì´ 'emily_pantheon'ì´ë‹ˆê¹Œ ì•„ë˜ì²˜ëŸ¼ ì„¤ì •í•´ì•¼ í° í™”ë©´ì´ ì•ˆ ëœ¹ë‹ˆë‹¤.
      - run: flutter build web --release --base-href "/emily_pantheon/"

      # 5. ê¹ƒí—ˆë¸Œ í˜ì´ì§€ ë°°í¬ (gh-pages ë¸Œëœì¹˜ë¡œ ì—…ë¡œë“œ)
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./build/web
